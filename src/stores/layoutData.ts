import { ref } from "vue";
import { defineStore } from "pinia";
import { ComponentsInfo } from "@/typings/Common";

const mock =
  '[{"name":"表单容器","type":"FROM","w":1200,"h":47,"x":188,"y":0,"i":"bYcT7q","icon":"","config":{"formKey":"form1","url":"https://mock.mengxuegu.com/mock/60177f772986555841710257/example/mock","method":"GET"},"position":{},"children":[{"name":"输入框","type":"INPUT","w":200,"h":32,"x":0,"y":0,"i":"JjC14d","icon":"","config":{"key":"appkey","value":""},"position":{},"column":[{"key":"key","type":"INPUT","label":"组件key"},{"key":"value","label":"文本","type":"INPUT"}],"moved":false},{"name":"下拉框","type":"SELECT","w":136,"h":31,"x":204,"y":0,"i":"vFL43q","icon":"","config":{"key":"platform","value":"1","options":[{"label":"android","value":"android"},{"label":"ios","value":"ios"}],"transformCode":"function transformData(data) {\\n      // data 表示接口返回的数据源2222\\n      const newData = []\\n      console.log(data);\\n  \\n      return newData  // 返回自定义数据结构\\n  }"},"position":{},"column":[{"key":"key","type":"INPUT","label":"组件key"},{"key":"value","label":"选项","type":"SELECT_EDIT"}],"moved":false},{"name":"下拉框","type":"SELECT","w":164,"h":32,"x":356,"y":0,"i":"CrxAti","icon":"","config":{"key":"notice","value":"1","options":[{"label":"通知消息","value":"1"},{"label":"自定义消息","value":"2"},{"label":"应用内消息","value":"3"},{"label":"应用内提醒","value":"4"}],"transformCode":"function transformData(data) {\\n      // data 表示接口返回的数据源2222\\n      const newData = []\\n      console.log(data);\\n  \\n      return newData  // 返回自定义数据结构\\n  }"},"position":{},"column":[{"key":"key","type":"INPUT","label":"组件key"},{"key":"value","label":"选项","type":"SELECT_EDIT"}],"moved":false},{"name":"下拉框","type":"SELECT","w":200,"h":32,"x":536,"y":0,"i":"jeeV0c","icon":"","config":{"key":"channel","value":"1","options":[{"label":"全部通道","value":""},{"label":"APNS","value":"APNS"},{"label":"极光通道","value":"JG"},{"label":"Live Acitiity","value":"LIVE"},{"label":"VOIP","value":"VOIP"}],"transformCode":"function transformData(data) {\\n      // data 表示接口返回的数据源2222\\n      const newData = []\\n      console.log(data);\\n  \\n      return newData  // 返回自定义数据结构\\n  }"},"position":{},"column":[{"key":"key","type":"INPUT","label":"组件key"},{"key":"value","label":"选项","type":"SELECT_EDIT"}],"moved":false},{"name":"下拉框","type":"SELECT","w":200,"h":32,"x":749,"y":0,"i":"6H7bMg","icon":"","config":{"key":"sdk","value":"1","options":[{"label":"全部SDK版本","value":""},{"label":"460","value":"460"},{"label":"470","value":"470"},{"label":"480","value":"480"},{"label":"490","value":"490"}],"transformCode":"function transformData(data) {\\n      // data 表示接口返回的数据源2222\\n      const newData = []\\n      console.log(data);\\n  \\n      return newData  // 返回自定义数据结构\\n  }"},"position":{},"column":[{"key":"key","type":"INPUT","label":"组件key"},{"key":"value","label":"选项","type":"SELECT_EDIT"}],"moved":false}],"column":[{"key":"formKey","type":"INPUT","label":"表单key"},{"key":"url","type":"INPUT","label":"请求url"},{"key":"method","type":"SELECT","label":"请求方法","options":[{"label":"GET","value":"GET"},{"label":"POST","value":"POST"}]}],"moved":false},{"name":"echart","type":"ECHARTS","w":1200,"h":343,"x":0,"y":47,"i":"pyQ17V","icon":"","config":{"echartData":{"tooltip":{"trigger":"axis","axisPointer":{"type":"shadow"}},"xAxis":{"type":"category","data":["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]},"yAxis":{"type":"value"},"series":[{"data":[120,200,150,80,70,110,130],"type":"bar"},{"data":[120,200,150,80,70,110,130],"type":"bar"}]},"link":"form1","transformCode":"function transformData(data) {\\n      // data 表示接口返回的数据源3333\\n      const newData = {\\n        tooltip: {\\n          trigger: \\"axis\\",\\n          axisPointer: {\\n            type: \\"shadow\\",\\n          },\\n        },\\n        xAxis: {\\n          type: \\"category\\",\\n          data: [\\"Mon\\", \\"Tue\\", \\"Wed\\", \\"Thu\\", \\"Fri\\", \\"Sat\\", \\"Sun\\"],\\n        },\\n        yAxis: {\\n          type: \\"value\\",\\n        },\\n        series: [\\n          {\\n            data: [120, 200, 150, 80, 70, 110, 130],\\n            type: \\"bar\\",\\n          },\\n          {\\n            data: [120, 200, 150, 80, 70, 110, 130],\\n            type: \\"bar\\",\\n          },\\n        ],\\n      }\\n      console.log(data);\\n  \\n      return newData  // 返回自定义数据结构\\n  }"},"position":{},"column":[{"key":"link","type":"INPUT","label":"关联表单key"},{"key":"transformCode","type":"CODE","label":"自定义转换函数","options":[]}],"moved":false}]';

// localStorage.setItem("layoutData", mock);
export const useLayoutDataStore = defineStore("layoutData", () => {
  const layoutData = ref<ComponentsInfo[]>([]);
  const currentId = ref(localStorage.getItem("currentId"));
  const data = localStorage.getItem("layoutData");
  if (data && data.length) {
    layoutData.value = JSON.parse(data);
  }
  return { layoutData, currentId };
});
